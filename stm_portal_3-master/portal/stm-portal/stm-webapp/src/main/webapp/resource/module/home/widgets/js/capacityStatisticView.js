
function capacityStatisticView (selector,opt){
	this.opt = {
	};
	this.opt.selector = selector;

	this.opt = $.extend(this.opt,opt,true);
	if(this.opt.selector)
		this.init();
	else
		throw('初始化失败!');
}
var csv = capacityStatisticView.prototype;

csv.init = function() {
	this.dataObj = $("<div/>");
	this.dataObj.css({width:'100%',height:'100%'});
	this.opt.selector.html(this.dataObj);
	this.plotDeviceCapacity();
};

csv.plotDeviceCapacity = function(){
	var data = [
		{name:'存储容量',value:30,type:'storage'},
		{name:'数据库容量',value:50,type:'database'},
		{name:'带宽容量',value:40,type:'bandwidth'},
		{name:'计算容量',value:70,type:'cpu'},
	]

	var w = (this.dataObj.width()-10) / data.length;
	var h = this.dataObj.height();
	//var boxSize = w>h?h:w;
	
	for(var i=0; i< data.length;i++){
		var obj = $('<div/>');
		//data[i].size = boxSize;
		data[i].w = w;
		data[i].h = h;

		obj.css({width:w+'px',
			height:h+'px',
			display:'inline-block'
		});

		this.dataObj.append(obj);
		
		_plotCircle(obj[0],data[i]);
		
	}

	function _plotCircle(div,data){
		//console.log(data);
		var symbols = {
		    storage:'path://M449.972,341.711c0,4.665,0,9.332,0,13.998 c-0.283,0.581-0.701,1.135-0.83,1.749c-4.489,21.383-19.97,36.717-41.354,39.836c-7.68,1.119-15.624,0.486-23.448,0.535 c-10.613,0.064-21.229,0.016-32.434,0.016c0-20.287-0.161-40.065,0.128-59.836c0.063-4.249,2.571-7.824,6.979-9.516 c2.379-0.912,4.673-2.044,8.042-3.536c-8.456-8.419-16.124-16.24-24.116-23.712c-0.777-0.727-4.152,0.102-5.336,1.236 c-6.605,6.339-12.927,12.975-19.288,19.565c-0.743,0.771-1.134,1.882-1.892,3.188c1.784,0.93,3.167,1.851,4.684,2.405 c7.021,2.567,9.928,7.573,9.864,14.972c-0.127,14.823,0.089,29.65,0.157,44.474c0.016,3.443,0.002,6.887,0.002,10.76 c-16.91,0-33.198,0.027-49.486-0.02c-3.824-0.012-7.725,0.162-11.459-0.494c-23.737-4.176-40.813-22.818-42.62-46.238 c-1.79-23.191,12.191-44.072,34.654-52.147c1.79-0.644,3.827-2.614,4.374-4.392c5.967-19.393,21.57-30.12,41.566-27.945 c3.07,0.334,4.279-1.264,6.192-2.938c6.08-5.321,11.858-11.537,18.929-15.027c7.537-3.72,22.555-7.312,37.027-5.414 c29.38,3.853,45.843,31.305,45.822,53.658c-0.003,2.914,1.289,4.362,3.942,5.999c6.275,3.873,12.469,8.154,17.806,13.21 C445.065,322.908,447.872,332.251,449.972,341.711z M362.15,384.828c14.352,0,27.994,0.564,41.57-0.154 c14.209-0.754,24.282-8.711,29.941-21.546c5.79-13.13,3.838-25.738-4.938-37.053c-6.666-8.595-15.856-12.834-26.542-13.791 c2.212-29.54-6.331-46.497-27.373-54.428c-9.301-3.505-18.807-4.014-28.379-1.103c-13.679,4.161-23.086,13.225-28.926,26.013 c-22.672-10.075-37.443-0.26-39.674,26.158c-1.375,0.219-2.82,0.518-4.279,0.673c-18.872,2.008-33.661,18.711-33.518,37.884 c0.142,19.016,14.904,35.981,33.559,37.182c15.088,0.973,30.268,0.555,45.406,0.727c0.262,0.002,0.527-0.33,1.117-0.727 c0.119-1.912,0.387-4.057,0.363-6.197c-0.117-10.652-0.451-21.305-0.42-31.958c0.017-5.676-1.836-9.073-7.705-10.993 c-10.963-3.583-12.24-10.243-4.195-18.411c7.715-7.832,15.543-15.556,23.088-23.547c7.512-7.956,11.681-8.19,19.386-0.358c7.24,7.359,14.02,15.227,21.711,22.073c11.403,10.15,7.562,19.395-4.88,21.373c-3.581,0.569-5.235,2.969-5.263,6.25C362.082,356.862,362.15,370.828,362.15,384.828z',
			database:'path://M398.975,361.885c0,40.995,0,81.99,0,122.985 c-3.776,10.585-11.588,17.313-21.203,22.41c-14.971,7.934-31.132,11.605-47.778,13.601c-5.667,0.68-11.338,1.324-17.008,1.984 c-9.332,0-18.664,0-27.996,0c-1.55-0.313-3.09-0.819-4.652-0.908c-17.276-0.982-34.195-3.748-50.369-10.132 c-13.479-5.32-25.991-11.831-30.968-26.955c0-40.995,0-81.99,0-122.985c3.382-11.283,11.621-18.012,21.514-23.379 c14.979-8.127,31.198-11.706,47.911-13.649c5.523-0.642,11.043-1.31,16.564-1.966c9.332,0,18.664,0,27.996,0 c1.718,0.319,3.424,0.824,5.154,0.929c15.111,0.917,30.095,2.877,44.318,8.16C377.922,337.722,393.178,344.148,398.975,361.885z M298.503,393.892c4.155,0,8.313,0.084,12.466-0.014c19.922-0.474,39.098-4.671,57.553-12.05c3.947-1.579,7.828-3.747,11.146-6.389 c7.49-5.963,7.544-13.794,0.106-19.75c-3.844-3.078-8.204-5.683-12.669-7.781c-14.419-6.776-29.942-9.199-45.604-11.167 c-24.323-3.057-48.375-1.826-72.072,4.321c-10.919,2.833-21.499,6.852-30.544,13.95c-8.228,6.456-8.277,15.013,0.208,21.094 c3.854,2.762,8.262,4.947,12.699,6.668C253.232,391.093,275.546,394.614,298.503,393.892z M386.812,462.31 c-58.912,26.976-117.076,28.347-175.671-0.245c0,3.707,0.349,7.204-0.063,10.609c-1.525,12.633,4.875,20.028,15.758,24.632 c17.905,7.575,36.839,10.587,55.999,12.532c17.458,1.773,34.838,0.63,52.107-2.048c15.672-2.431,30.725-6.825,44.006-15.945 c4.272-2.934,7.562-6.702,7.806-12.118C387.014,473.944,386.812,468.142,386.812,462.31z M386.829,422.173 c-58.815,27.938-117.042,27.818-175.688,0.059c0,4.211,0.298,8.36-0.059,12.452c-0.912,10.453,4.17,17.04,13.138,21.271 c2.989,1.41,5.98,2.891,9.11,3.909c38.335,12.474,77.112,14.047,116.293,4.438c10.313-2.529,20.561-5.283,29.416-11.548 c4.764-3.37,7.629-7.869,7.764-13.794C386.927,433.471,386.829,427.977,386.829,422.173z M386.789,386.99 c-58.898,26.295-117.034,26.209-175.185,0.224c-2.287,15.944,0.365,21.372,14.099,28.792c14.744,7.966,31.018,10.422,47.253,12.782 c21.741,3.159,43.426,2.05,64.977-1.938c14.406-2.667,28.547-6.18,40.82-14.75c3.868-2.701,7.572-5.794,7.961-10.898 C387.065,396.591,386.789,391.933,386.789,386.99z',
			bandwidth:'path://M566,428.813c-5.972,5.571-11.947,11.144-18.436,17.198 c-46.517-42.91-101.145-66.136-164.353-66.276c-62.942-0.138-117.63,21.866-166.418,68.838c-2.249-3.825-4.004-7.875-6.723-11.115 c-2.502-2.984-6.043-5.101-10.732-8.898c11.352-9.389,20.67-18.019,30.89-25.402c98.879-71.446,235.742-63.742,328.679,18.253 c2.251,1.983,4.724,3.716,7.093,5.564C566,427.587,566,428.201,566,428.813zM245.846,473.385c85.978-77.313,202.125-68.136,273.863,0.699 c-5.753,6.512-11.525,13.045-17.31,19.591c-79.483-63.907-158.985-62.428-239.111-2.982 C257.757,485.204,251.97,479.461,245.846,473.385zM291.686,519.799c56.117-49.853,130.684-47.634,182.225,0.348 c-6.111,5.472-12.206,10.928-18.922,16.938c-20.626-16.403-44.897-26.244-72.426-26.443c-27.585-0.2-52.069,8.857-73.096,26.82 C303.27,531.3,297.482,525.545,291.686,519.799zM381.598,599.859c-13.59-0.382-25.117-12.501-24.545-25.801 c0.59-13.662,12.397-24.675,26.052-24.299c13.598,0.377,25.14,12.504,24.559,25.804 C407.065,589.235,395.257,600.245,381.598,599.859z',
			cpu:'path://M304.363,366.449c5.53,0,10.626,0,16.156,0c0.163-3.535,0.086-7.185,0.26-10.927 c3.462,0,6.944,0.236,10.826,0.236c0,3.355,0,7.753,0,10.37c8.396-0.146,14.582-0.237,18.794,1.861 c6.031,3.005,4.481,13.778,4.481,21.134c3.397,0.17,6.517,0,10.271,0.187c0,3.382,0,6.636,0,10.49c-3.32,0-6.722,0-10.556,0 c0,5.778,0,10.973,0,16.644c3.479,0.181,6.894,0.359,10.598,0.553c0,3.512,0,6.764,0,10.454c-3.446,0.177-6.876,0.354-10.658,0.548 c0,5.326,0,10.413,0,16.096c3.293,0,6.69,0,10.529,0c0,3.936,0,7.293,0,11.271c-3.462,0-8.155,0-10.529,0 c0,6.186,1.484,15.172-1.633,18.845c-4.611,5.433-20.59,3.599-21.132,3.84c0,3.391,0.036,7.065,0.036,10.724 c-3.849,0-7.101,0-10.942,0c0-3.6,0-7.001,0-10.724c-5.669,0-10.756,0-16.483,0c-0.177,3.54,0.177,7.087-0.007,10.794 c-3.572,0-7.647,0-11.375,0c-0.193-3.429,0.025-6.828-0.191-10.675c-5.289,0-10.509,0-16.173,0 c-0.155,3.381,0.12,6.941-0.052,10.675c-3.476,0-7.534,0-11.417,0c0-3.374-0.046-8.19-0.046-10.794 c-7.833,0-13.175,0.794-18.287-2.325c-6.386-3.896-2.792-13.42-4.316-20.056c-3.342-0.169-6.755-0.34-10.506-0.529 c0-3.389,0-6.64,0-10.498c3.333,0,6.732,0,10.563,0c0-5.777,0-10.973,0-16.64c-3.496-0.176-6.91-0.349-10.608-0.535 c0-3.533,0-6.785,0-10.467c3.462-0.175,6.891-0.348,10.67-0.538c0-5.345,0-10.432,0-16.114c-3.306,0-6.706,0-10.541,0 c0-3.937,0-7.296,0-11.269c3.474,0,7.583-0.15,10.967-0.15c0.688-6.37-1.782-14.852,3.167-18.938 c5.645-4.661,11.833-3.69,18.997-3.683c0-3.461,0.125-6.966,0.125-10.624c3.847,0,7.098,0,10.941,0c0,3.581,0,6.993,0,10.719 c5.668,0,10.755,0,16.492,0c0.175-3.526,0.352-7.072,0.536-10.786c3.563,0,6.696,0,10.429,0 C303.943,359.029,304.135,362.428,304.363,366.449z M342.871,378.21c-29.771,0-59.132,0-88.416,0c0,29.668,0,58.867,0,88.12 c29.668,0,58.912,0,88.416,0C342.871,436.871,342.871,407.791,342.871,378.21zM298.961,455.055c-8.819,0.001-17.639-0.081-26.456,0.034 c-4.58,0.06-6.721-1.854-6.701-6.532c0.076-17.803,0.065-35.607,0.006-53.411c-0.014-4.342,1.846-6.448,6.273-6.437 c17.97,0.048,35.94,0.039,53.91,0.006c4.103-0.008,6.181,1.839,6.176,6.011c-0.018,18.137-0.014,36.273-0.004,54.41 c0.002,4.205-2.182,5.959-6.25,5.935C316.932,455.017,307.945,455.054,298.961,455.055z'
		};
		var option = {
		    title:{
		        text:data.name,
		        subtext:data.value + '%',
		        textStyle:{
		        	color:'#fff'
		        },
		        x:'center',
		        top:'70%'
		    },
		    tooltip: {
		        show:false,
		    },
		    legend: {show:false
		    },
		    series: [
		        {
		            name:'使用情况',
		            type:'pie',
		            center: ['50%', '40%'],
		            radius: ['50%', '70%'],
		            avoidLabelOverlap: false,
		            color:['#112a50','#0a9ce7'],
		            label: {
		                normal: {
		                    show: false,
		                    position: 'center'
		                },
		                emphasis: {
		                    show: false,
		                    textStyle: {
		                        fontSize: '30',
		                        fontWeight: 'bold'
		                    }
		                }
		            },
		            markPoint:{
		                label:{
		                    normal:{
		                        formatter:function(param){
		                            return '';
		                        }
		                    },
		                },
		                data:[{
		                    name:'图标',
		                    x:'50%',
		                    y:'40%',
		                    value:0,
		                    textStyle:{
		                        show:false
		                    },
		                    symbol:symbols[data.type],
		                    symbolSize:[(data.w*0.5)*40/69.625, (data.h*0.4)*30/95.2],//[40,30],
		                    itemStyle:{
		                        normal:{
		                            color:'white'
		                        }
		                    }
		                }]
		            },
		            labelLine: {
		                normal: {
		                    show: false
		                }
		            },
		            data:[
		                {value:100-data.value, name:'未使用'},
		                {value:data.value, name:'已经使用'}
		            ]
		        }
		    ]
		};

		//[(data.w*0.5)*40/69.625, (data.h*0.4)*30/95.2]
		//console.log((data.w * 0.5) + " " + (data.h * 0.4) );

		var myChart = echarts.init(div);
		myChart.setOption(option);
	}
}


csv.refresh = function(){
	this.plotDeviceCapacity();
}